<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Register</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #f5f7fa; }
  input, button { margin: 5px 0; padding: 8px; width: 100%; max-width: 400px; font-family: inherit; }
  button { background-color: #1e1e2f; color: #fff; border: none; border-radius: 4px; padding: 10px 15px; cursor: pointer; }
  button:hover { background-color: #343454; }
  #message { margin-top: 15px; font-weight: bold; }
  form { background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); max-width: 400px; }
</style>
</head>
<body>

<h1>Register</h1>
<form id="registerForm">
  <input type="text" id="username" placeholder="Username" required />
  <input type="email" id="email" placeholder="Email" required />
  <input type="password" id="password" placeholder="Password" required />
  <button type="submit">Register</button>
</form>
<div id="message"></div>

<script>
const form = document.getElementById('registerForm');

form.addEventListener('submit', async e => {
  e.preventDefault();

  const username = document.getElementById('username').value.trim();
  const email = document.getElementById('email').value.trim().toLowerCase();
  const password = document.getElementById('password').value;

  if (!username || !email || !password) {
    document.getElementById('message').innerText = 'Please fill in all fields.';
    return;
  }

  try {
    const res = await fetch('/register', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, email, password })
    });
    const data = await res.json();
    
    if (data.user_id) {
      document.getElementById('message').innerText = '✅ Registration successful! Please login.';
      form.reset();
      setTimeout(() => window.location.href = '/login.html', 1500);
    } else {
      document.getElementById('message').innerText = `❌ ${data.error || 'Registration failed.'}`;
    }
  } catch (err) {
    console.error('Registration failed:', err);
    document.getElementById('message').innerText = 'Error registering user. Check console.';
  }
});
</script>

</body>
</html>
